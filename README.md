# PhosphorVM

PhosphorVM is a very experimental runner for programs generated by GameMaker:Studio (without the YoYo Compiler).

## Building (Unix-like)

You will need CMake and a C++17 compiler.  

This *requires* `mmap` currently but fallbacks will be implemented for platforms that don't support it.

```
mkdir build
cd build
cmake ..
make -j
```

## What does this mean?

Usually (i.e. when not using YYC), GameMaker:Studio games are not compiled as native code directly. Instead, the toolchain generates a `data.win` file, which contains assets and game code, and an executable which is the GM:S runner.

PhosphorVM aims to be an alternative, open-source runner.  
Originally, the plan was to implement a full-blown GameMaker-compatible toolchain (like ENIGMA, AFAIK) but the focus has shifted, for various reasons.

## Why?

It's pretty fun and it's not too unreasonably complex for a project. If you get tired working on something you can spend time on another part of the software.

## Can I run any game with it?

Eventually you could, but in this very early state, PhosphorVM is virtually useless for users.

It is filled with debug code and doesn't do the same thing on every commit, simply because there is not much to test right now.

## *When* can I run any game with it?

Probably not soon.

A runner has a lot of things to care about. The GM:S bytecode is somewhat hard to implement efficiently because of all type combinations some of its instructions has to take care of. Other than that, implementing GM:S builtin functions will require a big amount of work, and of course reading out all the assets, etc. will be tedious.

To make matters worse, YoYoGames has (understandably) changed its `data.win` over releases and bytecode format a few times. Right now, only a specific version of the format is being implemented, but I would like to implement compatibility with older and newer versions of GM:S (the current focus being 1.4 compatibility).

## This has a unpacker; can I use it to extract resources from a game?

No, use something like Altar.NET for this. The internal PhosphorVM unpacker is only meant to prepare execution.

## How will performance be?

Probably not too far off the official runner. That being said, we can only guess good ways to interpret the bytecode. There are some design decisions that seem pretty cryptic to me and might be justified by how the official runner is implemented.

The VM will have lots of potential for optimization. The only other bottlenecks I can see coming are the builtin function interface and the graphics renderer.

## Is this legal?

Yes. PhosphorVM only parses and executes `data.win` files: It's a clean-room implementation of a GM:S runner, in a similar way to other projects including Wine or ReactOS.

## Can I contribute?

At the time, I don't think I need much help since things are moving around too quickly, and there's not much to do for now besides working on the VM.